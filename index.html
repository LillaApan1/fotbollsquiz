<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Fotbollsquiz</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  margin:0;
  font-family: Arial;
  background: linear-gradient(120deg,#0f2027,#203a43,#2c5364);
  color:white;
  text-align:center;
}
.box {
  max-width:500px;
  margin:50px auto;
  background:rgba(0,0,0,0.6);
  padding:25px;
  border-radius:15px;
}
button {
  width:100%;
  padding:12px;
  margin:8px 0;
  font-size:16px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
button:hover { opacity:0.9; }
input {
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:8px;
  border:none;
}
</style>
</head>

<body>

<div id="login" class="box">
  <h2>Skriv ditt namn</h2>
  <input id="username" placeholder="Ditt namn">
  <button id="startBtn">Forts√§tt</button>
</div>

<div id="menu" class="box" style="display:none;">
  <h2>V√§lj quiz</h2>
  <button onclick="startQuiz('pl')">Premier League</button>
  <button onclick="startQuiz('vm')">VM</button>
  <button onclick="startQuiz('as')">Allsvenskan</button>
</div>

<div id="quiz" class="box" style="display:none;">
  <h3 id="progress"></h3>
  <h2 id="question"></h2>
  <div id="answers"></div>
</div>

<div id="result" class="box" style="display:none;">
  <h2 id="scoreText"></h2>
  <h3>üèÜ Topp 3 i v√§rlden</h3>
  <ol id="top3"></ol>
  <p id="myRank"></p>
</div>

<script>
/* ================= FIREBASE ================= */

const firebaseConfig = {
  apiKey: "AIzaSyBApn2aTw1V7smbRbtwyvdDpD1iBJvzcY0",
  authDomain: "global-football-quiz.firebaseapp.com",
  projectId: "global-football-quiz",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ================= QUIZDATA ================= */

const quizzes = {
pl: [
{q:"Vilket lag vann Premier League 2015/16?",a:["Chelsea","Leicester","Arsenal"],c:1},
{q:"Flest m√•l under en PL-s√§song?",a:["Salah","Haaland","Su√°rez"],c:1},
{q:"Vilket lag har flest PL-titlar?",a:["Man United","Chelsea","Man City"],c:0},
{q:"Vem gjorde m√•let som s√§krade Man Citys titel 2012?",a:["Ag√ºero","Silva","Tour√©"],c:0},
{q:"Vilket lag √•kte ur PL 2007/08 trots 40 po√§ng?",a:["Birmingham","Reading","Derby"],c:1},
{q:"üî• F√∂rsta utl√§ndska spelaren som blev PL-skyttekung?",a:["Cantona","Henry","Bergkamp"],c:0},
{q:"üî• Vilket lag hade 'Invincibles'?",a:["Chelsea","Arsenal","Man United"],c:1},
{q:"üî• Rekord f√∂r flest assist p√• en s√§song?",a:["De Bruyne","Henry","√ñzil"],c:0},
{q:"üî• F√∂rsta laget som vann PL utan att spela i Europa?",a:["Blackburn","Leicester","Chelsea"],c:0},
{q:"üî• Vilken tr√§nare vann flest matcher i PL-historien?",a:["Ferguson","Guardiola","Wenger"],c:0},
{q:"Vilket lag spelar p√• Anfield?",a:["Everton","Liverpool","Leeds"],c:1},
{q:"Vilken klubb kallades 'The Invincibles'?",a:["Arsenal","Chelsea","City"],c:0},
{q:"Vilket √•r startade Premier League?",a:["1992","1988","1995"],c:0},
{q:"Vem har flest r√∂da kort i PL?",a:["Vieira","Dunne","Keane"],c:1},
{q:"Vilket lag vann PL 2020?",a:["Liverpool","City","Chelsea"],c:0},
{q:"Vem √§r PL:s b√§sta m√•lskytt genom tiderna?",a:["Shearer","Kane","Rooney"],c:0},
{q:"Vilken klubb har smeknamnet Spurs?",a:["Arsenal","Tottenham","West Ham"],c:1},
{q:"Vilket lag vann PL flest g√•nger p√• 90-talet?",a:["United","Arsenal","Blackburn"],c:0},
{q:"Vilken spelare kallas 'King of assists'?",a:["Giggs","De Bruyne","Lampard"],c:0},
{q:"Vilket lag spelar p√• Old Trafford?",a:["Leeds","Man United","Everton"],c:1}
]
,
  vm: [
{q:"Vilket land vann VM 2018?",a:["Frankrike","Kroatien","Brasilien"],c:0},
{q:"Flest VM-m√•l totalt?",a:["Klose","Ronaldo","Pel√©"],c:0},
{q:"VM 2002 vanns av?",a:["Brasilien","Tyskland","Italien"],c:0},
{q:"Vilket land har flest VM-guld?",a:["Brasilien","Tyskland","Italien"],c:0},
{q:"F√∂rsta VM spelades √•r?",a:["1930","1934","1928"],c:0},
{q:"üî• F√∂rsta afrikanska laget till kvartsfinal?",a:["Kamerun","Nigeria","Senegal"],c:0},
{q:"üî• Vem gjorde 'Hand of God'?",a:["Maradona","Pel√©","Messi"],c:0},
{q:"üî• Flest m√•l i ett VM?",a:["Just Fontaine","Klose","Ronaldo"],c:0},
{q:"üî• VM-final 1950 spelades i?",a:["Brasilien","Uruguay","Chile"],c:0},
{q:"üî• Enda landet som spelat alla VM?",a:["Brasilien","Tyskland","Argentina"],c:0},
{q:"Vilket land vann VM 2014?",a:["Tyskland","Brasilien","Argentina"],c:0},
{q:"VM 2010 h√∂lls i?",a:["Sydafrika","Brasilien","Japan"],c:0},
{q:"Vilken spelare vann VM 2022?",a:["Messi","Mbapp√©","Neymar"],c:0},
{q:"Vilket land var v√§rd 2022?",a:["Qatar","UAE","Saudiarabien"],c:0},
{q:"Vilket land vann VM 1998?",a:["Frankrike","Brasilien","Italien"],c:0},
{q:"Vilken spelare gjorde flest m√•l VM 2018?",a:["Kane","Griezmann","Mbapp√©"],c:0},
{q:"VM spelas vart?",a:["4:e √•r","2:e √•r","6:e √•r"],c:0},
{q:"Vilket land slog Brasilien 7‚Äì1?",a:["Tyskland","Frankrike","Nederl√§nderna"],c:0},
{q:"Vilket land vann VM 2006?",a:["Italien","Frankrike","Brasilien"],c:0},
{q:"Vilket lag vann VM 1930?",a:["Uruguay","Argentina","Brasilien"],c:0}
]
,
  as: [
{q:"Vilket lag har flest SM-guld?",a:["Malm√∂ FF","IFK G√∂teborg","AIK"],c:0},
{q:"Allsvenskan startade?",a:["1924","1910","1930"],c:0},
{q:"Vilket lag vann Allsvenskan 2023?",a:["Malm√∂ FF","Elfsborg","H√§cken"],c:1},
{q:"Vilket lag spelar p√• Tele2 Arena?",a:["AIK","Djurg√•rden","B√•da"],c:2},
{q:"Vilket lag kallas Bl√•vitt?",a:["IFK G√∂teborg","IFK Norrk√∂ping","Helsingborg"],c:0},
{q:"üî• Vilket lag vann Allsvenskan 2001?",a:["Hammarby","AIK","Djurg√•rden"],c:0},
{q:"üî• Flest m√•l i Allsvenskan genom tiderna?",a:["Sven Jonasson","Zlatan","Nordahl"],c:0},
{q:"üî• F√∂rsta laget fr√•n Norrland i Allsvenskan?",a:["GIF Sundsvall","√ñstersund","Gefle"],c:0},
{q:"üî• Vilket lag har spelat flest s√§songer?",a:["AIK","IFK G√∂teborg","Malm√∂ FF"],c:0},
{q:"üî• St√∂rsta segern n√•gonsin?",a:["12‚Äì0","11‚Äì1","10‚Äì0"],c:0},
{q:"Vilket lag vann 2020?",a:["Malm√∂ FF","Djurg√•rden","H√§cken"],c:0},
{q:"Vilket lag kallas Bajen?",a:["Hammarby","AIK","Djurg√•rden"],c:0},
{q:"Vilket lag spelar p√• Eleda Stadion?",a:["Malm√∂ FF","Helsingborg","Trelleborg"],c:0},
{q:"Vilket lag vann 2019?",a:["Djurg√•rden","AIK","Malm√∂"],c:0},
{q:"Vilket lag kallas Gnaget?",a:["AIK","Djurg√•rden","Hammarby"],c:0},
{q:"Vilket lag vann 2022?",a:["H√§cken","Malm√∂","Elfsborg"],c:0},
{q:"Vilken stad har flest derbyn?",a:["Stockholm","G√∂teborg","Malm√∂"],c:0},
{q:"Vilket lag spelar p√• Gamla Ullevi?",a:["IFK G√∂teborg","GAIS","B√•da"],c:2},
{q:"Vilket lag vann 2018?",a:["AIK","Malm√∂","Hammarby"],c:0},
{q:"Vilket lag kallas √Ñnglarna?",a:["IFK G√∂teborg","Elfsborg","√ñrebro"],c:0}
]

};

/* ================= VARIABLER ================= */

let user="";
let quiz=[];
let current=0;
let score=0;
let timeLeft=10;
let timer=null;

/* ================= LOGIN ================= */

document.getElementById("startBtn").onclick = () => {
  const name = document.getElementById("username").value.trim();
  if(!name){ alert("Skriv ditt namn"); return; }
  user=name;
  document.getElementById("login").style.display="none";
  document.getElementById("menu").style.display="block";
};

/* ================= QUIZ ================= */

function startQuiz(type){
  quiz=[...quizzes[type]].sort(()=>Math.random()-0.5);
  current=0;
  score=0;
  document.getElementById("menu").style.display="none";
  document.getElementById("quiz").style.display="block";
  showQuestion();
}

function showQuestion(){
  clearInterval(timer);
  timeLeft=10;

  const q=quiz[current];
  document.getElementById("question").innerText=q.q;
  document.getElementById("progress").innerText=
    `Fr√•ga ${current+1} av ${quiz.length} ‚è±Ô∏è ${timeLeft}s`;

  const answers=document.getElementById("answers");
  answers.innerHTML="";

  q.a.forEach((text,i)=>{
    const btn=document.createElement("button");
    btn.innerText=text;
    btn.onclick=()=>answer(i);
    answers.appendChild(btn);
  });

  timer=setInterval(()=>{
    timeLeft--;
    document.getElementById("progress").innerText=
      `Fr√•ga ${current+1} av ${quiz.length} ‚è±Ô∏è ${timeLeft}s`;
    if(timeLeft<=0){
      clearInterval(timer);
      next();
    }
  },1000);
}

function answer(i){
  if(i===quiz[current].c) score++;
  next();
}

function next(){
  current++;
  current<quiz.length ? showQuestion() : finish();
}

/* ================= RESULT ================= */

async function finish(){
  document.getElementById("quiz").style.display="none";
  document.getElementById("result").style.display="block";
  document.getElementById("scoreText").innerText=
    `${user}, du fick ${score} po√§ng`;

  const ref=db.collection("players").doc(user);
  const snap=await ref.get();
  let total=score;
  if(snap.exists) total+=snap.data().points;
  await ref.set({points:total});

  const list=await db.collection("players")
    .orderBy("points","desc").get();

  let rank=0;
  const top3=document.getElementById("top3");
  top3.innerHTML="";

  list.forEach(d=>{
    rank++;
    if(rank<=3){
      const li=document.createElement("li");
      li.innerText=`${d.id} ‚Äì ${d.data().points} po√§ng`;
      top3.appendChild(li);
    }
    if(d.id===user){
      document.getElementById("myRank").innerText=
        `Din plats i v√§rlden: #${rank} (${d.data().points} po√§ng)`;
    }
  });
}
</script>

</body>
</html>
